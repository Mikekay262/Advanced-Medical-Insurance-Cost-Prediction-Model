"0","rf_bayesian <- function(mtry, min_node_size) {"
"0","  model <- randomForest("
"0","    charges ~ age + age_squared + bmi + children + smoker + region + smoker_bmi,"
"0","    data = train_data,"
"0","    mtry = as.integer(mtry),"
"0","    nodesize = as.integer(min_node_size)"
"0","  )"
"0","  predictions <- predict(model, test_data)"
"0","  rmse <- calc_rmse(test_data$charges, predictions)"
"0","  list(Score = -rmse)"
"0","}"
"0",""
"0","set.seed(42)"
"0","rf_bo <- BayesianOptimization("
"0","  FUN = rf_bayesian,"
"0","  bounds = list(mtry = c(2L, 5L), min_node_size = c(5L, 15L)),"
"0","  init_points = 5,"
"0","  n_iter = 20,"
"0","  acq = ""ucb"""
"0",")"
"1","elapsed = 2.57	Round = 1	mtry = 5.0000	min_node_size = 10.0000	Value = -5288.5540"
"1"," "
"1","
"
"1","elapsed = 2.33	Round = 2	mtry = 5.0000	min_node_size = 12.0000	Value = -5276.7645"
"1"," "
"1","
"
"1","elapsed = 1.56	Round = 3	mtry = 3.0000	min_node_size = 6.0000	Value = -5295.0543"
"1"," "
"1","
"
"1","elapsed = 1.59	Round = 4	mtry = 4.0000	min_node_size = 12.0000	Value = -5269.7620"
"1"," "
"1","
"
"1","elapsed = 1.67	Round = 5	mtry = 4.0000	min_node_size = 12.0000	Value = -5255.5042"
"1"," "
"1","
"
"1","elapsed = 0.76	Round = 6	mtry = 2.0000	min_node_size = 12.0000	Value = -5175.6109"
"1"," "
"1","
"
"1","elapsed = 1.02	Round = 7	mtry = 2.0000	min_node_size = 5.0000	Value = -5195.7240"
"1"," "
"1","
"
"1","elapsed = 0.75	Round = 8	mtry = 2.0000	min_node_size = 14.0000	Value = -5184.0545"
"1"," "
"1","
"
"1","elapsed = 0.74	Round = 9	mtry = 2.0000	min_node_size = 10.0000	Value = -5190.2363"
"1"," "
"1","
"
"1","elapsed = 0.71	Round = 10	mtry = 2.0000	min_node_size = 12.0000	Value = -5206.5339"
"1"," "
"1","
"
"1","elapsed = 0.72	Round = 11	mtry = 2.0000	min_node_size = 12.0000	Value = -5173.1805"
"1"," "
"1","
"
"1","elapsed = 0.71	Round = 12	mtry = 2.0000	min_node_size = 12.0000	Value = -5187.9912"
"1"," "
"1","
"
"1","elapsed = 0.72	Round = 13	mtry = 2.0000	min_node_size = 12.0000	Value = -5191.4101"
"1"," "
"1","
"
"1","elapsed = 0.69	Round = 14	mtry = 2.0000	min_node_size = 12.0000	Value = -5180.6849"
"1"," "
"1","
"
"1","elapsed = 0.86	Round = 15	mtry = 2.0000	min_node_size = 12.0000	Value = -5173.3701"
"1"," "
"1","
"
"1","elapsed = 0.70	Round = 16	mtry = 2.0000	min_node_size = 12.0000	Value = -5185.2254"
"1"," "
"1","
"
"1","elapsed = 0.75	Round = 17	mtry = 2.0000	min_node_size = 12.0000	Value = -5189.3970"
"1"," "
"1","
"
"1","elapsed = 0.68	Round = 18	mtry = 2.0000	min_node_size = 12.0000	Value = -5162.4277"
"1"," "
"1","
"
"1","elapsed = 0.77	Round = 19	mtry = 2.0000	min_node_size = 12.0000	Value = -5183.1236"
"1"," "
"1","
"
"1","elapsed = 0.70	Round = 20	mtry = 2.0000	min_node_size = 12.0000	Value = -5164.5908"
"1"," "
"1","
"
"1","elapsed = 0.72	Round = 21	mtry = 2.0000	min_node_size = 12.0000	Value = -5191.8742"
"1"," "
"1","
"
"1","elapsed = 0.78	Round = 22	mtry = 2.0000	min_node_size = 12.0000	Value = -5185.4855"
"1"," "
"1","
"
"1","elapsed = 0.68	Round = 23	mtry = 2.0000	min_node_size = 12.0000	Value = -5182.5062"
"1"," "
"1","
"
"1","elapsed = 0.71	Round = 24	mtry = 2.0000	min_node_size = 12.0000	Value = -5172.3029"
"1"," "
"1","
"
"1","elapsed = 0.91	Round = 25	mtry = 2.0000	min_node_size = 12.0000	Value = -5181.5966"
"1"," "
"1","
"
"1","
 Best Parameters Found: 
"
"1","Round = 18	mtry = 2.0000	min_node_size = 12.0000	Value = -5162.4277"
"1"," "
"1","
"
"0","# Train the optimized Random Forest model"
"0","rf_optimized <- randomForest("
"0","  charges ~ age + age_squared + bmi + children + smoker + region + smoker_bmi,"
"0","  data = train_data,"
"0","  mtry = rf_bo$Best_Par[""mtry""],"
"0","  nodesize = rf_bo$Best_Par[""min_node_size""]"
"0",")"
"0","rf_predictions_optimized <- predict(rf_optimized, test_data)"
"0","rf_rmse_optimized <- calc_rmse(test_data$charges, rf_predictions_optimized)"
"0","cat(""Optimized Random Forest RMSE:"", rf_rmse_optimized, ""\n"")"
"1","Optimized Random Forest RMSE:"
"1"," "
"1","5189.678"
"1"," "
"1","
"
