"0","# Refine the model by excluding non-significant predictors"
"0","refined_model <- lm(formula = charges ~ age_squared + children + smoker +  region + smoker_bmi, data = train_data)"
"0",""
"0","# Summarize the refined model"
"0","summary(refined_model)"
"1","
Call:
"
"1",""
"1","lm(formula = charges ~ age_squared + children + smoker + region + 
    smoker_bmi, data = train_data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-14551.7 "
"1"," -1548.3 "
"1"," -1287.5 "
"1","  -888.2 "
"1"," 22896.5 "
"1","
"
"1","
Coefficients:
"
"1","               "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)    "
"1","  2.345e+03"
"1","  3.963e+02"
"1","   5.917"
"1"," 4.42e-09"
"1"," ***"
"1","
age_squared    "
"1","  3.418e+00"
"1","  1.271e-01"
"1","  26.890"
"1","  < 2e-16"
"1"," ***"
"1","
children       "
"1","  6.367e+02"
"1","  1.187e+02"
"1","   5.362"
"1"," 1.01e-07"
"1"," ***"
"1","
smokeryes      "
"1"," -2.112e+04"
"1","  1.569e+03"
"1"," -13.461"
"1","  < 2e-16"
"1"," ***"
"1","
regionnorthwest"
"1"," -4.730e+02"
"1","  4.086e+02"
"1","  -1.157"
"1","  0.24736"
"1","    "
"1","
regionsoutheast"
"1"," -1.044e+03"
"1","  4.024e+02"
"1","  -2.593"
"1","  0.00963"
"1"," ** "
"1","
regionsouthwest"
"1"," -1.056e+03"
"1","  4.163e+02"
"1","  -2.538"
"1","  0.01130"
"1"," *  "
"1","
smoker_bmi     "
"1","  1.456e+03"
"1","  4.946e+01"
"1","  29.446"
"1","  < 2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","4655"
"1"," "
"1","on"
"1"," "
"1","1064"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.8537"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8528"
"1"," "
"1","
F-statistic:"
"1"," "
"1","887.2"
"1"," "
"1","on"
"1"," "
"1","7"
"1"," "
"1","and"
"1"," "
"1","1064"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","# Calculate RMSE for the refined model"
"0","predicted_values <- predict(refined_model, newdata = train_data)"
"0","actual_values <- train_data$charges"
"0","rmse_refined <- sqrt(mean((predicted_values - actual_values)^2))"
"0",""
"0","cat(""Refined Model RMSE:"", rmse_refined, ""\n"")"
"1","Refined Model RMSE:"
"1"," "
"1","4637.44"
"1"," "
"1","
"
